---
import BaseHead from "../../components/BaseHead.astro";
import Header from "../../components/Header.jsx";
import Footer from "../../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION, JOB_TITLE } from "../../consts";
import { getCollection } from "astro:content";
import FormattedDate from "../../components/FormattedDate.astro";
import me from "../../assets/me.png";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const title = `${SITE_TITLE} | Blog`;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <BaseHead title={title} description={SITE_DESCRIPTION} />
    <style>
      ul {
        list-style-type: none;
        padding: unset;
      }
      ul li {
        display: flex;
      }
      ul li :global(time) {
        flex: 0 0 130px;
        font-style: italic;
        color: #595959;
      }
      ul li a:visited {
        color: #8e32dc;
      }
    </style>
  </head>
  <body>
    <Header client:load />
    <main
      class="flex flex-col gap-4 align-middle items-center justify-center w-screen dark:bg-gray-900 dark:text-gray-50 min-h-[var(--screen-height)]"
    >
      <div class="bg-white dark:bg-gray-900 py-4 sm:py-4">
        <div class="mx-auto max-w-7xl px-6 lg:px-8">
          <div class="mx-auto max-w-2xl lg:max-w-4xl">
            <h2
              class="text-3xl font-bold tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl"
            >
              Posts
            </h2>
            <!--<p class="mt-2 text-lg leading-8 text-gray-600 dark:text-gray-300">
              Learn how to grow your business with our expert advice.
            </p> -->
            <div class="mt-4 space-y-20 lg:mt-8 lg:space-y-20">
              {
                posts.map((post) => (
                  <article class="relative isolate flex flex-col gap-8 lg:flex-row">
                    <div class="relative aspect-[16/9] sm:aspect-[2/1] lg:aspect-square lg:w-64 lg:shrink-0">
                      <img
                        src={post.data.heroImage}
                        alt={post.data.title}
                        class="absolute inset-0 h-full w-full rounded-2xl bg-gray-50 dark:bg-gray-800 object-cover"
                      />
                      <div class="absolute inset-0 rounded-2xl ring-1 ring-inset ring-gray-900/10 dark:ring-gray-50/10" />
                    </div>
                    <div>
                      <div class="flex items-center gap-x-4 text-xs">
                        <time datetime="2020-03-16" class="text-gray-500">
                          <FormattedDate date={post.data.pubDate} />
                        </time>
                        {post.data.category && (
                          <div class="relative z-10 rounded-full bg-gray-50 dark:bg-gray-800 px-3 py-1.5 font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                            {post.data.category}
                          </div>
                        )}
                      </div>
                      <div class="group relative max-w-xl">
                        <h3 class="mt-3 text-lg font-semibold leading-6 text-gray-900 dark:text-gray-50 group-hover:text-gray-600 dark:group-hover:text-gray-300">
                          <a href={`/blog/${post.slug}/`}>
                            <span class="absolute inset-0" />
                            {post.data.title}
                          </a>
                        </h3>
                        <p class="mt-5 text-sm leading-6 text-gray-600 dark:text-gray-300">
                          {post.data.description}
                        </p>
                      </div>
                      <div class="mt-6 flex border-t border-gray-900/5 dark:border-gray-100/5 pt-6">
                        <div class="relative flex items-center gap-x-4">
                          <img
                            src={me.src}
                            alt="Author"
                            class="h-10 w-10 rounded-full bg-gray-50 dark:bg-gray-900 object-cover"
                          />
                          <div class="text-sm leading-6">
                            <p class="font-semibold text-gray-900 dark:text-gray-50">
                              <a href="/about">
                                <span class="absolute inset-0" />
                                Jake Hayes
                              </a>
                            </p>
                            <p class="text-gray-600 dark:text-gray-300">
                              {JOB_TITLE}
                            </p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </article>
                ))
              }
            </div>
          </div>
        </div>
      </div>
    </main>
    <Footer />
  </body>
</html>
